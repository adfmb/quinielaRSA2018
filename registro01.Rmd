---
title: "QUINIELA RUSIA 2018"
subtitle: "Sígueme A 2018"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    # vertical_layout: scroll
    logo: football-soccer-ball-48-183228.png
    theme: cerulean
    source_code: "https://github.com/adfmb/quinielaRSA2018"
runtime: shiny
---
<!-- [id]: russia09.png -->

```{r setup, include=FALSE}
library(flexdashboard)
library(shiny)
library(png)
library(dplyr)
source("utils/calcula_goles.R")
source("utils/etopn.R")
options(warn = 0)
options(digits = 0)
library(shinyjs)
useShinyjs()
```

Registro∫ {.sidebar data-width=200}
=======================================================================
```{r fig.width=2, fig.height=2.9,echo=FALSE}
library(jpeg)
library(png)
library(grid)
# img <- readJPEG("www/russia01.jpg")
img <- readPNG("www/russia02.png")

grid.raster(img)
 # img(src='www/russia03.png', align = "center")
```

```{r echo=FALSE}
textInput("nombre_part", "Nombre completo del participante")

textInput("nombre_equipo", "Nombre de quien te invitó")

textInput("correo", "Correo electrónico del participante")
```
<!-- Sidebar {.sidebar data-width=200}
=======================================================================
<!-- ```{r fig.width=.5, fig.height=.5,echo=FALSE}
library(jpeg)
library(grid)
# img <- readJPEG("www/russia01.jpg")
# img <- readJPEG("www/Sigueme03.jpg")
img <- readPNG("www/Sigueme05.png")

grid.raster(img)
<!-- ``` -->


Fase de grupos
=======================================================================

Row {data-height=270}
-----------------------------------------------------------------------
<!-- ```{r fig.width=20, fig.height=4,echo=FALSE}
library(jpeg)
library(png)
library(grid)
# img <- readJPEG("www/russia01.jpg")
# img <- readPNG("www/russia07.png")
# img <- readJPEG("www/Sigueme02.jpg")
# img <- readJPEG("www/russia05.jpg")

# grid.raster(img)
 img(src='www/russia09.png', align = "center")
<!-- ``` -->
<!-- ![](www/russia09.png){#id .class width=1200 height=320px} -->
<!-- ![](www/russia09.png){ width=100% height=30% } -->
[![](www/russia14.jpg){#id .class width=1150 height=230px}](http://www.fifa.com/worldcup/)
<!-- ![](www/russia12.jpg){#id .class width=1150 height=300px} -->
<!-- ![](www/russia15.png){#id .class width=1150 height=300px} -->
<!-- http://www.squawka.com/news/world-cup-2018-russias-stadiums-in-pictures/201955#2oEbD5Hqu7cCUy2y.97 -->

Row {data-height=280} {.tabset}
-----------------------------------------------------------------------

### Grupo A

```{r echo=FALSE}
Grupo<-"A"
v1<-rbind(c(paste0(Grupo,"_p1_e1"), "Rusia"),
    c(paste0(Grupo,"_p1_e2"), "Arabia S"),
    c(paste0(Grupo,"_p2_e1"), "Egipto"),
    c(paste0(Grupo,"_p2_e2"), "Uruguay"),
    c(paste0(Grupo,"_p3_e1"), "Rusia"),
    c(paste0(Grupo,"_p3_e2"), "Egipto"),
    c(paste0(Grupo,"_p4_e1"), "Uruguay"),
    c(paste0(Grupo,"_p4_e2"), "Arabia S"),
    c(paste0(Grupo,"_p5_e1"), "Uruguay"),
    c(paste0(Grupo,"_p5_e2"), "Rusia"),
    c(paste0(Grupo,"_p6_e1"), "Arabia S"),
    c(paste0(Grupo,"_p6_e2"), "Egipto")
)
colnames(v1)<-c("Codigo","Equipo")
dataA<-data.frame(as.data.frame(v1))
dataA$Codigo<-as.character(dataA$Codigo)
dataA$Equipo<-as.character(dataA$Equipo)
  
 lista2A<-eventReactive(input$buttonA, {
   
  calcula_Goles(vectorgoles=c(input$A_p1_e1,input$A_p1_e2,
                              input$A_p2_e1,input$A_p2_e2,
                              input$A_p3_e1,input$A_p3_e2,
                              input$A_p4_e1,input$A_p4_e2,
                              input$A_p5_e1,input$A_p5_e2,
                              input$A_p6_e1,input$A_p6_e2
                     ),
                data=dataA)
  })
sidebarLayout(position = "right",
              sidebarPanel(
                
                # renderDataTable(data.frame("numeros"=rnorm(6),"num2"=rnorm(6))),
                # renderTable(as.matrix(data.frame("Equipo"=unique(data$Equipo),
                #                                  "G"=input$A_p1_e1,
                #                                  "P"=input$A_p1_e2,
                #                                  "E"=rnorm(4),
                #                                  "GF"=rnorm(4),
                #                                  "GC"=rnorm(4),
                #                                  "D"=rnorm(4),
                #                                  "Pts"=input$A_p6_e2))),
                
                renderTable({
                  if(!is.null(lista2A()$data_resumenEquipos)){
                    as.matrix(lista2A()$data_resumenEquipos)
                    
                  }else{
                    m<-matrix("Por favor revisa que las cantidades ingresadas sean correctas")
                    colnames(m)<-"¡¡¡AGUAS!!!!"
                    m
                  }
                  
                }),
                
                width = 4
                
              ),
              mainPanel(
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p1_e1"), dataA$Equipo[1], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p1_e2"), dataA$Equipo[2], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p2_e1"), dataA$Equipo[3], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p2_e2"), dataA$Equipo[4], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  )
                ),
                
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p3_e1"), dataA$Equipo[5], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p3_e2"), dataA$Equipo[6], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p4_e1"), dataA$Equipo[7], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p4_e2"), dataA$Equipo[8], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p5_e1"), dataA$Equipo[9], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p5_e2"), dataA$Equipo[10], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p6_e1"), dataA$Equipo[11], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p6_e2"), dataA$Equipo[12], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                width = 8
              )
)

fluidRow(
  # tags$head(
  #   tags$style(HTML('#buttonA{background-color:orange}'))
  # ),
  column(2, actionButton("buttonA", "Actualizar", icon("paper-plane"), 
    style="color: #0066ff;background-image:-webkit-linear-gradient(#fff, #fff 60%, #f5f5f5)")
  ))
```


### Grupo B

```{r}
Grupo<-"B"
v1<-rbind(c(paste0(Grupo,"_p1_e1"), "Marruecos"),
    c(paste0(Grupo,"_p1_e2"), "Irán"),
    c(paste0(Grupo,"_p2_e1"), "Portugal"),
    c(paste0(Grupo,"_p2_e2"), "España"),
    c(paste0(Grupo,"_p3_e1"), "Portugal"),
    c(paste0(Grupo,"_p3_e2"), "Marruecos"),
    c(paste0(Grupo,"_p4_e1"), "Irán"),
    c(paste0(Grupo,"_p4_e2"), "España"),
    c(paste0(Grupo,"_p5_e1"), "Irán"),
    c(paste0(Grupo,"_p5_e2"), "Portugal"),
    c(paste0(Grupo,"_p6_e1"), "España"),
    c(paste0(Grupo,"_p6_e2"), "Marruecos")
)
colnames(v1)<-c("Codigo","Equipo")
dataB<-data.frame(as.data.frame(v1))
dataB$Codigo<-as.character(dataB$Codigo)
dataB$Equipo<-as.character(dataB$Equipo)
  
 lista2B<-eventReactive(input$buttonB, {
   
  calcula_Goles(vectorgoles=c(input$B_p1_e1,input$B_p1_e2,
                              input$B_p2_e1,input$B_p2_e2,
                              input$B_p3_e1,input$B_p3_e2,
                              input$B_p4_e1,input$B_p4_e2,
                              input$B_p5_e1,input$B_p5_e2,
                              input$B_p6_e1,input$B_p6_e2
                     ),
                data=dataB)
  })
sidebarLayout(position = "right",
              sidebarPanel(
            
                
                renderTable({
                  if(!is.null(lista2B()$data_resumenEquipos)){
                    as.matrix(lista2B()$data_resumenEquipos)
                    
                  }else{
                    m<-matrix("Por favor revisa que las cantidades ingresadas sean correctas")
                    colnames(m)<-"¡¡¡AGUAS!!!!"
                    m
                  }
                  
                }),
                
                width = 4
                
              ),
                mainPanel(
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p1_e1"), dataB$Equipo[1], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p1_e2"), dataB$Equipo[2], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p2_e1"), dataB$Equipo[3], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p2_e2"), dataB$Equipo[4], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  )
                ),
                
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p3_e1"), dataB$Equipo[5], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p3_e2"), dataB$Equipo[6], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p4_e1"), dataB$Equipo[7], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p4_e2"), dataB$Equipo[8], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p5_e1"), dataB$Equipo[9], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p5_e2"), dataB$Equipo[10], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p6_e1"), dataB$Equipo[11], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p6_e2"), dataB$Equipo[12], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                width = 8
              )
)

fluidRow(
  column(2, actionButton("buttonB", "Actualizar")
  ))
```

### Grupo C

```{r}
Grupo<-"C"
v1<-rbind(c(paste0(Grupo,"_p1_e1"), "Francia"),
    c(paste0(Grupo,"_p1_e2"), "Australia"),
    c(paste0(Grupo,"_p2_e1"), "Perú"),
    c(paste0(Grupo,"_p2_e2"), "Dinamarca"),
    c(paste0(Grupo,"_p3_e1"), "Dinamarca"),
    c(paste0(Grupo,"_p3_e2"), "Australia"),
    c(paste0(Grupo,"_p4_e1"), "Francia"),
    c(paste0(Grupo,"_p4_e2"), "Perú"),
    c(paste0(Grupo,"_p5_e1"), "Dinamarca"),
    c(paste0(Grupo,"_p5_e2"), "Francia"),
    c(paste0(Grupo,"_p6_e1"), "Australia"),
    c(paste0(Grupo,"_p6_e2"), "Perú")
)
colnames(v1)<-c("Codigo","Equipo")
dataC<-data.frame(as.data.frame(v1))
dataC$Codigo<-as.character(dataC$Codigo)
dataC$Equipo<-as.character(dataC$Equipo)
  
 lista2C<-eventReactive(input$buttonC, {
   
  calcula_Goles(vectorgoles=c(input$C_p1_e1,input$C_p1_e2,
                              input$C_p2_e1,input$C_p2_e2,
                              input$C_p3_e1,input$C_p3_e2,
                              input$C_p4_e1,input$C_p4_e2,
                              input$C_p5_e1,input$C_p5_e2,
                              input$C_p6_e1,input$C_p6_e2
                     ),
                data=dataC)
  })
sidebarLayout(position = "right",
              sidebarPanel(
            
                
                renderTable({
                  if(!is.null(lista2C()$data_resumenEquipos)){
                    as.matrix(lista2C()$data_resumenEquipos)
                    
                  }else{
                    m<-matrix("Por favor revisa que las cantidades ingresadas sean correctas")
                    colnames(m)<-"¡¡¡AGUAS!!!!"
                    m
                  }
                  
                }),
                
                width = 4
                
              ),
             mainPanel(
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p1_e1"), dataC$Equipo[1], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p1_e2"), dataC$Equipo[2], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p2_e1"), dataC$Equipo[3], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p2_e2"), dataC$Equipo[4], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  )
                ),
                
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p3_e1"), dataC$Equipo[5], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p3_e2"), dataC$Equipo[6], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p4_e1"), dataC$Equipo[7], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p4_e2"), dataC$Equipo[8], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p5_e1"), dataC$Equipo[9], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p5_e2"), dataC$Equipo[10], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p6_e1"), dataC$Equipo[11], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p6_e2"), dataC$Equipo[12], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                width = 8
              )
)

fluidRow(
  column(2, actionButton("buttonC", "Actualizar")
  ))
```


### Grupo D

```{r}
Grupo<-"D"
v1<-rbind(c(paste0(Grupo,"_p1_e1"), "Argentina"),
    c(paste0(Grupo,"_p1_e2"), "Islandia"),
    c(paste0(Grupo,"_p2_e1"), "Croacia"),
    c(paste0(Grupo,"_p2_e2"), "Nigeria"),
    c(paste0(Grupo,"_p3_e1"), "Argentina"),
    c(paste0(Grupo,"_p3_e2"), "Croacia"),
    c(paste0(Grupo,"_p4_e1"), "Nigeria"),
    c(paste0(Grupo,"_p4_e2"), "Islandia"),
    c(paste0(Grupo,"_p5_e1"), "Nigeria"),
    c(paste0(Grupo,"_p5_e2"), "Argentina"),
    c(paste0(Grupo,"_p6_e1"), "Islandia"),
    c(paste0(Grupo,"_p6_e2"), "Croacia")
)
colnames(v1)<-c("Codigo","Equipo")
dataD<-data.frame(as.data.frame(v1))
dataD$Codigo<-as.character(dataD$Codigo)
dataD$Equipo<-as.character(dataD$Equipo)
  
 lista2D<-eventReactive(input$buttonD, {
   
  calcula_Goles(vectorgoles=c(input$D_p1_e1,input$D_p1_e2,
                              input$D_p2_e1,input$D_p2_e2,
                              input$D_p3_e1,input$D_p3_e2,
                              input$D_p4_e1,input$D_p4_e2,
                              input$D_p5_e1,input$D_p5_e2,
                              input$D_p6_e1,input$D_p6_e2
                     ),
                data=dataD)
  })
sidebarLayout(position = "right",
              sidebarPanel(
            
                
                renderTable({
                  if(!is.null(lista2D()$data_resumenEquipos)){
                    as.matrix(lista2D()$data_resumenEquipos)
                    
                  }else{
                    m<-matrix("Por favor revisa que las cantidades ingresadas sean correctas")
                    colnames(m)<-"¡¡¡AGUAS!!!!"
                    m
                  }
                  
                }),
                
                width = 4
                
              ),
              mainPanel(
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p1_e1"), dataD$Equipo[1], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p1_e2"), dataD$Equipo[2], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p2_e1"), dataD$Equipo[3], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p2_e2"), dataD$Equipo[4], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  )
                ),
                
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p3_e1"), dataD$Equipo[5], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p3_e2"), dataD$Equipo[6], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p4_e1"), dataD$Equipo[7], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p4_e2"), dataD$Equipo[8], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p5_e1"), dataD$Equipo[9], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p5_e2"), dataD$Equipo[10], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p6_e1"), dataD$Equipo[11], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p6_e2"), dataD$Equipo[12], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                width = 8
              )
)

fluidRow(
  column(2, actionButton("buttonD", "Actualizar")
  ))
```


### Grupo E

```{r}
Grupo<-"E"
v1<-rbind(c(paste0(Grupo,"_p1_e1"), "Costa R"),
    c(paste0(Grupo,"_p1_e2"), "Serbia"),
    c(paste0(Grupo,"_p2_e1"), "Brasil"),
    c(paste0(Grupo,"_p2_e2"), "Suiza"),
    c(paste0(Grupo,"_p3_e1"), "Brasil"),
    c(paste0(Grupo,"_p3_e2"), "Costa R"),
    c(paste0(Grupo,"_p4_e1"), "Serbia"),
    c(paste0(Grupo,"_p4_e2"), "Suiza"),
    c(paste0(Grupo,"_p5_e1"), "Serbia"),
    c(paste0(Grupo,"_p5_e2"), "Brasil"),
    c(paste0(Grupo,"_p6_e1"), "Suiza"),
    c(paste0(Grupo,"_p6_e2"), "Costa R")
)
colnames(v1)<-c("Codigo","Equipo")
dataE<-data.frame(as.data.frame(v1))
dataE$Codigo<-as.character(dataE$Codigo)
dataE$Equipo<-as.character(dataE$Equipo)
  
 lista2E<-eventReactive(input$buttonE, {
   
  calcula_Goles(vectorgoles=c(input$E_p1_e1,input$E_p1_e2,
                              input$E_p2_e1,input$E_p2_e2,
                              input$E_p3_e1,input$E_p3_e2,
                              input$E_p4_e1,input$E_p4_e2,
                              input$E_p5_e1,input$E_p5_e2,
                              input$E_p6_e1,input$E_p6_e2
                     ),
                data=dataE)
  })
sidebarLayout(position = "right",
              sidebarPanel(
            
                
                renderTable({
                  if(!is.null(lista2E()$data_resumenEquipos)){
                    as.matrix(lista2E()$data_resumenEquipos)
                    
                  }else{
                    m<-matrix("Por favor revisa que las cantidades ingresadas sean correctas")
                    colnames(m)<-"¡¡¡AGUAS!!!!"
                    m
                  }
                  
                }),
                
                width = 4
                
              ),
              mainPanel(
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p1_e1"), dataE$Equipo[1], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p1_e2"), dataE$Equipo[2], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p2_e1"), dataE$Equipo[3], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p2_e2"), dataE$Equipo[4], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  )
                ),
                
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p3_e1"), dataE$Equipo[5], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p3_e2"), dataE$Equipo[6], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p4_e1"), dataE$Equipo[7], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p4_e2"), dataE$Equipo[8], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p5_e1"), dataE$Equipo[9], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p5_e2"), dataE$Equipo[10], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p6_e1"), dataE$Equipo[11], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p6_e2"), dataE$Equipo[12], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                width = 8
              )
)

fluidRow(
  column(2, actionButton("buttonE", "Actualizar")
  ))
```

### Grupo F

```{r}
Grupo<-"F"
v1<-rbind(c(paste0(Grupo,"_p1_e1"), "Alemania"),
          c(paste0(Grupo,"_p1_e2"), "México"),
          c(paste0(Grupo,"_p2_e1"), "Suecia"),
          c(paste0(Grupo,"_p2_e2"), "Corea S"),
          c(paste0(Grupo,"_p3_e1"), "Corea S"),
          c(paste0(Grupo,"_p3_e2"), "México"),
          c(paste0(Grupo,"_p4_e1"), "Alemania"),
          c(paste0(Grupo,"_p4_e2"), "Suecia"),
          c(paste0(Grupo,"_p5_e1"), "México"),
          c(paste0(Grupo,"_p5_e2"), "Suecia"),
          c(paste0(Grupo,"_p6_e1"), "Corea S"),
          c(paste0(Grupo,"_p6_e2"), "Alemania")
)
colnames(v1)<-c("Codigo","Equipo")
dataF<-data.frame(as.data.frame(v1))
dataF$Codigo<-as.character(dataF$Codigo)
dataF$Equipo<-as.character(dataF$Equipo)
# source("utils/partidosF.R")
 lista2F<-eventReactive(input$buttonF, {
   
  calcula_Goles(vectorgoles=c(input$F_p1_e1,input$F_p1_e2,
                              input$F_p2_e1,input$F_p2_e2,
                              input$F_p3_e1,input$F_p3_e2,
                              input$F_p4_e1,input$F_p4_e2,
                              input$F_p5_e1,input$F_p5_e2,
                              input$F_p6_e1,input$F_p6_e2
                     ),
                data=dataF)
  })
sidebarLayout(position = "right",
              sidebarPanel(
            
                
                renderTable({
                  if(!is.null(lista2F()$data_resumenEquipos)){
                    as.matrix(lista2F()$data_resumenEquipos)
                    
                  }else{
                    m<-matrix("Por favor revisa que las cantidades ingresadas sean correctas")
                    colnames(m)<-"¡¡¡AGUAS!!!!"
                    m
                  }
                  
                }),
                
                width = 4
                
              ),
              mainPanel(
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p1_e1"), dataF$Equipo[1], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p1_e2"), dataF$Equipo[2], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p2_e1"), dataF$Equipo[3], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p2_e2"), dataF$Equipo[4], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  )
                ),
                
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p3_e1"), dataF$Equipo[5], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p3_e2"), dataF$Equipo[6], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p4_e1"), dataF$Equipo[7], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p4_e2"), dataF$Equipo[8], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p5_e1"), dataF$Equipo[9], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p5_e2"), dataF$Equipo[10], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p6_e1"), dataF$Equipo[11], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p6_e2"), dataF$Equipo[12], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                width = 8
              )
)

fluidRow(
  column(2, actionButton("buttonF", "Actualizar")
  ))
```

### Grupo G

```{r}
Grupo<-"G"
v1<-rbind(c(paste0(Grupo,"_p1_e1"), "Bélgica"),
          c(paste0(Grupo,"_p1_e2"), "Panamá"),
          c(paste0(Grupo,"_p2_e1"), "Túnez"),
          c(paste0(Grupo,"_p2_e2"), "Inglaterra"),
          c(paste0(Grupo,"_p3_e1"), "Bélgica"),
          c(paste0(Grupo,"_p3_e2"), "Túnez"),
          c(paste0(Grupo,"_p4_e1"), "Inglaterra"),
          c(paste0(Grupo,"_p4_e2"), "Panamá"),
          c(paste0(Grupo,"_p5_e1"), "Panamá"),
          c(paste0(Grupo,"_p5_e2"), "Túnez"),
          c(paste0(Grupo,"_p6_e1"), "Inglaterra"),
          c(paste0(Grupo,"_p6_e2"), "Bélgica")
)
colnames(v1)<-c("Codigo","Equipo")
dataG<-data.frame(as.data.frame(v1))
dataG$Codigo<-as.character(dataG$Codigo)
dataG$Equipo<-as.character(dataG$Equipo)
  
 lista2G<-eventReactive(input$buttonG, {
   
  calcula_Goles(vectorgoles=c(input$G_p1_e1,input$G_p1_e2,
                              input$G_p2_e1,input$G_p2_e2,
                              input$G_p3_e1,input$G_p3_e2,
                              input$G_p4_e1,input$G_p4_e2,
                              input$G_p5_e1,input$G_p5_e2,
                              input$G_p6_e1,input$G_p6_e2
                     ),
                data=dataG)
  })
sidebarLayout(position = "right",
              sidebarPanel(
            
                
                renderTable({
                  if(!is.null(lista2G()$data_resumenEquipos)){
                    as.matrix(lista2G()$data_resumenEquipos)
                    
                  }else{
                    m<-matrix("Por favor revisa que las cantidades ingresadas sean correctas")
                    colnames(m)<-"¡¡¡AGUAS!!!!"
                    m
                  }
                  
                }),
                
                width = 4
                
              ),
               mainPanel(
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p1_e1"), dataG$Equipo[1], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p1_e2"), dataG$Equipo[2], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p2_e1"), dataG$Equipo[3], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p2_e2"), dataG$Equipo[4], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  )
                ),
                
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p3_e1"), dataG$Equipo[5], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p3_e2"), dataG$Equipo[6], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p4_e1"), dataG$Equipo[7], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p4_e2"), dataG$Equipo[8], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p5_e1"), dataG$Equipo[9], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p5_e2"), dataG$Equipo[10], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p6_e1"), dataG$Equipo[11], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p6_e2"), dataG$Equipo[12], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                width = 8
              )
)

fluidRow(
  column(2, actionButton("buttonG", "Actualizar")
  ))
```


### Grupo H

```{r}
Grupo<-"H"
v1<-rbind(c(paste0(Grupo,"_p1_e1"), "Colombia"),
          c(paste0(Grupo,"_p1_e2"), "Japón"),
          c(paste0(Grupo,"_p2_e1"), "Polonia"),
          c(paste0(Grupo,"_p2_e2"), "Senegal"),
          c(paste0(Grupo,"_p3_e1"), "Japón"),
          c(paste0(Grupo,"_p3_e2"), "Senegal"),
          c(paste0(Grupo,"_p4_e1"), "Polonia"),
          c(paste0(Grupo,"_p4_e2"), "Colombia"),
          c(paste0(Grupo,"_p5_e1"), "Japón"),
          c(paste0(Grupo,"_p5_e2"), "Polonia"),
          c(paste0(Grupo,"_p6_e1"), "Senegal"),
          c(paste0(Grupo,"_p6_e2"), "Colombia")
)
colnames(v1)<-c("Codigo","Equipo")
dataH<-data.frame(as.data.frame(v1))
dataH$Codigo<-as.character(dataH$Codigo)
dataH$Equipo<-as.character(dataH$Equipo)
  
 lista2H<-eventReactive(input$buttonH, {
   
  calcula_Goles(vectorgoles=c(input$H_p1_e1,input$H_p1_e2,
                              input$H_p2_e1,input$H_p2_e2,
                              input$H_p3_e1,input$H_p3_e2,
                              input$H_p4_e1,input$H_p4_e2,
                              input$H_p5_e1,input$H_p5_e2,
                              input$H_p6_e1,input$H_p6_e2
                     ),
                data=dataH)
  })
sidebarLayout(position = "right",
              sidebarPanel(
            
                
                renderTable({
                  if(!is.null(lista2H()$data_resumenEquipos)){
                    as.matrix(lista2H()$data_resumenEquipos)
                    
                  }else{
                    m<-matrix("Por favor revisa que las cantidades ingresadas sean correctas")
                    colnames(m)<-"¡¡¡AGUAS!!!!"
                    m
                  }
                  
                }),
                
                width = 4
                
              ),
              mainPanel(
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p1_e1"), dataH$Equipo[1], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p1_e2"), dataH$Equipo[2], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p2_e1"), dataH$Equipo[3], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"),tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p2_e2"), dataH$Equipo[4], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  )
                ),
                
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p3_e1"), dataH$Equipo[5], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p3_e2"), dataH$Equipo[6], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p4_e1"), dataH$Equipo[7], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p4_e2"), dataH$Equipo[8], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                
                fluidRow(
                  column(2, 
                         numericInput(paste0(Grupo,"_p5_e1"), dataH$Equipo[9], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p5_e2"), dataH$Equipo[10], min=0, max=100, value=0,step=1,
                                      width = '65px')),
                  
                  
                  column(2, 
                         numericInput(paste0(Grupo,"_p6_e1"), dataH$Equipo[11], min=0, max=100, value=0,step=1,
                                      width = '65px')
                  ),
                  column(2,
                         tags$div(
                           HTML(paste(tags$span(style="color:white", "----"), tags$span(style="color:red", "vs"), sep = ""))
                         )),
                  column(2,
                         numericInput(paste0(Grupo,"_p6_e2"), dataH$Equipo[12], min=0, max=100, value=0,step=1,
                                      width = '65px'))
                  
                  
                ),
                width = 8
              )
)

fluidRow(
  column(2, actionButton(paste0("button",Grupo), "Actualizar")
  ))
```


Octavos de Final
=======================================================================
```{r}
ea<-reactive({#input$buttonA, {
  etopn(lista2A()$data_resumenEquipos)
})
eb<-reactive({#input$buttonB, {
  etopn(lista2B()$data_resumenEquipos)
})
ec<-reactive({#input$buttonC, {
  etopn(lista2C()$data_resumenEquipos)
})
ed<-reactive({#input$buttonD, {
  etopn(lista2D()$data_resumenEquipos)
})
ee<-reactive({#input$buttonE, {
  etopn(lista2E()$data_resumenEquipos)
})
ef<-reactive({#input$buttonF, {
  etopn(lista2F()$data_resumenEquipos)
})
eg<-reactive({#input$buttonG, {
  etopn(lista2G()$data_resumenEquipos)
})
eh<-reactive({#input$buttonH, {
  etopn(lista2H()$data_resumenEquipos)
})

v8s <- reactiveValues(OK = c(F,F,F,F,
                           F,F,F,F))
observeEvent(input$buttonA, {
    v8s$OK[1] <- lista2A()$marcaBoton
  })

observeEvent(input$buttonB, {
    v8s$OK[2] <- lista2B()$marcaBoton
  })

observeEvent(input$buttonC, {
    v8s$OK[3] <- lista2C()$marcaBoton
  })

observeEvent(input$buttonD, {
    v8s$OK[4] <- lista2D()$marcaBoton
  })

observeEvent(input$buttonE, {
    v8s$OK[5] <- lista2E()$marcaBoton
  })

observeEvent(input$buttonF, {
    v8s$OK[6] <- lista2F()$marcaBoton
  })

observeEvent(input$buttonG, {
    v8s$OK[7] <- lista2G()$marcaBoton
  })

observeEvent(input$buttonH, {
    v8s$OK[8] <- lista2H()$marcaBoton
  })

alarma8vos<-paste0("¡O.O Nos caemos a pedazos!")
```

Row
-------------------------------------
    
### [W49]
    
```{r}

Grupo1<-"A"
Grupo2<-"B"

fluidRow(
        
        column(4,
               h2(paste0("1",Grupo1))
              ),
  
        column(4,
         numericInput(paste0("E1",Grupo1),
                      renderUI(
                        if(!is.null(lista2A()$data_resumenEquipos)){
                          paste0(ea()[1])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
fluidRow(

   column(4,
           tags$div(
             HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
          )),

        column(4,
         tags$div(
                 HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
               ))

)

fluidRow(
        column(4,
               h2(paste0("2",Grupo2))
              ),
  
        column(4,
         numericInput(paste0("E2",Grupo2),
                      renderUI(
                        if(!is.null(lista2B()$data_resumenEquipos)){
                          paste0(eb()[2])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2B()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
```
 
### [W50]
    
```{r}
Grupo1<-"C"
Grupo2<-"D"
p<-"W50"

fluidRow(
        
        column(4,
               h2(paste0("1",Grupo1))
              ),
  
        column(4,
         numericInput(paste0("E1",Grupo1),
                      renderUI(
                        if(!is.null(lista2C()$data_resumenEquipos)){
                          paste0(ec()[1])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2C()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
fluidRow(

   column(4,
           tags$div(
             HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
          )),

        column(4,
         tags$div(
                 HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
               ))

)

fluidRow(
        column(4,
               h2(paste0("2",Grupo2))
              ),
  
        column(4,
         numericInput(paste0("E2",Grupo2),
                      renderUI(
                        if(!is.null(lista2D()$data_resumenEquipos)){
                          paste0(ed()[2])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2D()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
``` 

### [W53]
    
```{r}
Grupo1<-"E"
Grupo2<-"F"

fluidRow(
        
        column(4,
               h2(paste0("1",Grupo1))
              ),
  
        column(4,
         numericInput(paste0("E1",Grupo1),
                      renderUI(
                        if(!is.null(lista2E()$data_resumenEquipos)){
                          paste0(ee()[1])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2E()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
fluidRow(

   column(4,
           tags$div(
             HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
          )),

        column(4,
         tags$div(
                 HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
               ))

)

fluidRow(
        column(4,
               h2(paste0("2",Grupo2))
              ),
  
        column(4,
         numericInput(paste0("E2",Grupo2),
                      renderUI(
                        if(!is.null(lista2F()$data_resumenEquipos)){
                          paste0(ef()[2])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2F()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
```
 
### [W54]
    
```{r}
Grupo1<-"G"
Grupo2<-"H"

fluidRow(
        
        column(4,
               h2(paste0("1",Grupo1))
              ),
  
        column(4,
         numericInput(paste0("E1",Grupo1),
                      renderUI(
                        if(!is.null(lista2G()$data_resumenEquipos)){
                          paste0(eg()[1])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2G()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
fluidRow(

   column(4,
           tags$div(
             HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
          )),

        column(4,
         tags$div(
                 HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
               ))

)

fluidRow(
        column(4,
               h2(paste0("2",Grupo2))
              ),
  
        column(4,
         numericInput(paste0("E2",Grupo2),
                      renderUI(
                        if(!is.null(lista2H()$data_resumenEquipos)){
                          paste0(eh()[2])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2H()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
``` 


Row
-------------------------------------
    
### [W51]
    
```{r}
Grupo1<-"B"
Grupo2<-"A"

fluidRow(
        
        column(4,
               h2(paste0("1",Grupo1))
              ),
  
        column(4,
         numericInput(paste0("E1",Grupo1),
                      renderUI(
                        if(!is.null(lista2B()$data_resumenEquipos)){
                          paste0(eb()[1])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2B()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
fluidRow(

   column(4,
           tags$div(
             HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
          )),

        column(4,
         tags$div(
                 HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
               ))

)

fluidRow(
        column(4,
               h2(paste0("2",Grupo2))
              ),
  
        column(4,
         numericInput(paste0("E2",Grupo2),
                      renderUI(
                        if(!is.null(lista2A()$data_resumenEquipos)){
                          paste0(ea()[2])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
```
 
### [W52]
    
```{r}
Grupo1<-"D"
Grupo2<-"C"

fluidRow(
        
        column(4,
               h2(paste0("1",Grupo1))
              ),
  
        column(4,
         numericInput(paste0("E1",Grupo1),
                      renderUI(
                        if(!is.null(lista2D()$data_resumenEquipos)){
                          paste0(ed()[1])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2D()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
fluidRow(

   column(4,
           tags$div(
             HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
          )),

        column(4,
         tags$div(
                 HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
               ))

)

fluidRow(
        column(4,
               h2(paste0("2",Grupo2))
              ),
  
        column(4,
         numericInput(paste0("E2",Grupo2),
                      renderUI(
                        if(!is.null(lista2C()$data_resumenEquipos)){
                          paste0(ec()[2])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2C()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
``` 

### [W55]
    
```{r}
Grupo1<-"F"
Grupo2<-"E"

fluidRow(
        
        column(4,
               h2(paste0("1",Grupo1))
              ),
  
        column(4,
         numericInput(paste0("E1",Grupo1),
                      renderUI(
                        if(!is.null(lista2F()$data_resumenEquipos)){
                          paste0(ef()[1])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2F()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
fluidRow(

   column(4,
           tags$div(
             HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
          )),

        column(4,
         tags$div(
                 HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
               ))

)

fluidRow(
        column(4,
               h2(paste0("2",Grupo2))
              ),
  
        column(4,
         numericInput(paste0("E2",Grupo2),
                      renderUI(
                        if(!is.null(lista2E()$data_resumenEquipos)){
                          paste0(ee()[2])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2E()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
```
 
### [W56]
    
```{r}
Grupo1<-"H"
Grupo2<-"G"

fluidRow(
        
        column(4,
               h2(paste0("1",Grupo1))
              ),
  
        column(4,
         numericInput(paste0("E1",Grupo1),
                      renderUI(
                        if(!is.null(lista2H()$data_resumenEquipos)){
                          paste0(eh()[1])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos##,unique(lista2H()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
fluidRow(

   column(4,
           tags$div(
             HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
          )),

        column(4,
         tags$div(
                 HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
               ))

)

fluidRow(
        column(4,
               h2(paste0("2",Grupo2))
              ),
  
        column(4,
         numericInput(paste0("E2",Grupo2),
                      renderUI(
                        if(!is.null(lista2G()$data_resumenEquipos)){
                          paste0(eg()[2])}
                        else{
                          tags$span(style="color:red",
                                   alarma8vos###,unique(as.character(lista2G()$data_EquipoPartido$Grupo)),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                            width = '100px')
        )
)
``` 

Row {data-height=100}
-------------------------------------


```{r}
library(shinyjs)

dataW<-reactive({data.frame("Codigo"=c("W_49_E1","W_49_E2", #paste(Etapa,p,"E1",sep="_"),paste(Etapa,p,"E2",sep="_")
                                       "W_50_E1","W_50_E2",
                                       "W_53_E1","W_53_E2",
                                       "W_54_E1","W_54_E2",
                                       "W_51_E1","W_51_E2",
                                       "W_52_E1","W_52_E2",
                                       "W_55_E1","W_55_E2",
                                       "W_56_E1","W_56_E2"),
                  "Equipo"=c(paste0(ea()[1]),paste0(eb()[2]),
                             paste0(ec()[1]),paste0(ed()[2]),
                             paste0(ee()[1]),paste0(ef()[2]),
                             paste0(eg()[1]),paste0(eh()[2]),
                             paste0(eb()[1]),paste0(ea()[2]),
                             paste0(ed()[1]),paste0(ec()[2]),
                             paste0(ef()[1]),paste0(ee()[2]),
                             paste0(eh()[1]),paste0(eg()[2]))
                             )
  # eventReactive({ input$buttonA input$buttonB input$buttonC input$buttonD input$buttonE input$buttonF input$buttonG input$buttonH}
  })


lista8vos<-eventReactive(input$button8vos,{

  if(v8s$OK[1] & v8s$OK[2] & v8s$OK[3] & v8s$OK[4] & v8s$OK[5] & v8s$OK[6] & v8s$OK[7] & v8s$OK[8]){
    # print("holi")
    calcula_Goles(vectorgoles=c(input[["E1A"]],input[["E2B"]],#input[[paste0("E1",Grupo1)]],
                              input[["E1C"]],input[["E2D"]],
                              input[["E1E"]],input[["E2F"]],
                              input[["E1G"]],input[["E2H"]],
                              input[["E1B"]],input[["E2A"]],
                              input[["E1D"]],input[["E2C"]],
                              input[["E1F"]],input[["E2E"]],
                              input[["E1H"]],input[["E2G"]]),
    data=dataW()
    )
  }else{
      "MENSAJE SIN CONCLUIR PRIMERA FASE"
    }
})
  fluidRow(
        
        column(7,
          actionButton("button8vos","  NO TE VAYAS SIN ACTUALIZARME    :P")
        ),

column(7,
renderTable({
  if(lista8vos()=="MENSAJE SIN CONCLUIR PRIMERA FASE"){
    m<-matrix("PRIMERA FASE SIN CONCLUIR CORRECTAMENTE")
    colnames(m)<-"¡¡¡O.O!!!!"
    m
  }else if(!is.null(lista8vos()$data_EquipoPartido)){
        if(lista2A()$marcaBoton & lista2B()$marcaBoton){
          if(lista8vos()$marcaBoton){
            if(sum(lista8vos()$data_EquipoPartido$Empate)==0){
              as.matrix(lista8vos()$data_EquipoPartido[1:8,c("Grupo","Partido","Equipo")])
            }else{
              m<-matrix("</3 Cámbialo porfiiiiis")
              colnames(m)<-"¡¡¡NO MAMAR QUE PUSISTE EMPATES!!!!"
              m
            }
            
          }else{
            m<-matrix("Por favor revisa que las cantidades de Segunda Fase sean correctas :O")
            colnames(m)<-"¡¡¡AGUAS!!!!"
              m
        }
        }else{
          m<-matrix("Por favor revisa que las cantidades de Primera Fase sean correctas :O")
          colnames(m)<-"¡¡¡AGUAS!!!!"
          m
        }
  
      }else{
        m<-matrix("Por favor revisa que las cantidades ingresadas sean correctas")
        colnames(m)<-"¡¡¡AGUAS!!!!"
        m
      }

                })

)
)
```




Cuartos de Final
=======================================================================
  
```{r}
e49<-reactive({#input$buttonA, {
  etopn(lista8vos()$data_EquipoPartido[lista8vos()$data_EquipoPartido$Partido==49,],n=1)
})
e50<-reactive({#input$buttonA, {
  etopn(lista8vos()$data_EquipoPartido[lista8vos()$data_EquipoPartido$Partido==50,],n=1)
})
e51<-reactive({#input$buttonA, {
  etopn(lista8vos()$data_EquipoPartido[lista8vos()$data_EquipoPartido$Partido==51,],n=1)
})
e52<-reactive({#input$buttonA, {
  etopn(lista8vos()$data_EquipoPartido[lista8vos()$data_EquipoPartido$Partido==52,],n=1)
})
e53<-reactive({#input$buttonA, {
  etopn(lista8vos()$data_EquipoPartido[lista8vos()$data_EquipoPartido$Partido==53,],n=1)
})
e54<-reactive({#input$buttonA, {
  etopn(lista8vos()$data_EquipoPartido[lista8vos()$data_EquipoPartido$Partido==54,],n=1)
})
e55<-reactive({#input$buttonA, {
  etopn(lista8vos()$data_EquipoPartido[lista8vos()$data_EquipoPartido$Partido==55,],n=1)
})
e56<-reactive({#input$buttonA, {
  etopn(lista8vos()$data_EquipoPartido[lista8vos()$data_EquipoPartido$Partido==56,],n=1)
})

v4s <- reactiveValues(OK = c(F,F))

observeEvent(input$button8vos, {
  if(lista8vos()=="MENSAJE SIN CONCLUIR PRIMERA FASE"){
    v4s$OK[1] <- F
    v4s$OK[2] <- F
  }else{
    v4s$OK[1] <- lista8vos()$marcaBoton
    v4s$OK[2] <- sum(lista8vos()$data_EquipoPartido$Empate)==0
  }
})

alarma4s<-paste0("¡O.O Terminemos con las fases anteriores :D!")
```

Row
-------------------------------------
  
### [W57]
  
```{r}

partido1<-49
partido2<-50

fluidRow(
  
  column(4,
         h2(paste0("W",partido1))
  ),
  
  column(4,
         numericInput(paste0("W",partido1),
                      renderUI(
                        if(lista8vos()!="MENSAJE SIN CONCLUIR PRIMERA FASE"){
                          if(!is.null(lista8vos()$data_resumenEquipos)){
                            paste0(e49()[1])}
                        }else{
                          tags$span(style="color:red",
                                    alarma4s##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
fluidRow(
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
         )),
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
         ))
  
)

fluidRow(
  column(4,
         h2(paste0("W",partido2))
  ),
  
  column(4,
         numericInput(paste0("W",partido2),
                      renderUI(
                        if(lista8vos()!="MENSAJE SIN CONCLUIR PRIMERA FASE"){
                          if(!is.null(lista8vos()$data_resumenEquipos)){
                            paste0(e50()[1])}
                        }else{
                          tags$span(style="color:red",
                                    alarma4s##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
```

### [W59]

```{r}

partido1<-51
partido2<-52

fluidRow(
  
  column(4,
         h2(paste0("W",partido1))
  ),
  
  column(4,
         numericInput(paste0("W",partido1),
                      renderUI(
                        if(lista8vos()!="MENSAJE SIN CONCLUIR PRIMERA FASE"){
                          if(!is.null(lista8vos()$data_resumenEquipos)){
                            paste0(e51()[1])}
                        }else{
                          tags$span(style="color:red",
                                    alarma4s##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
fluidRow(
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
         )),
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
         ))
  
)

fluidRow(
  column(4,
         h2(paste0("W",partido2))
  ),
  
  column(4,
         numericInput(paste0("W",partido2),
                      renderUI(
                        if(lista8vos()!="MENSAJE SIN CONCLUIR PRIMERA FASE"){
                          if(!is.null(lista8vos()$data_resumenEquipos)){
                            paste0(e52()[1])}
                        }else{
                          tags$span(style="color:red",
                                    alarma4s##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
```

Row
-------------------------------------
  
### [W58]
  
```{r}
partido1<-53
partido2<-54

fluidRow(
  
  column(4,
         h2(paste0("W",partido1))
  ),
  
  column(4,
         numericInput(paste0("W",partido1),
                      renderUI(
                        if(lista8vos()!="MENSAJE SIN CONCLUIR PRIMERA FASE"){
                          if(!is.null(lista8vos()$data_resumenEquipos)){
                            paste0(e53()[1])}
                        }else{
                          tags$span(style="color:red",
                                    alarma4s##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
fluidRow(
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
         )),
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
         ))
  
)

fluidRow(
  column(4,
         h2(paste0("W",partido2))
  ),
  
  column(4,
         numericInput(paste0("W",partido2),
                      renderUI(
                        if(lista8vos()!="MENSAJE SIN CONCLUIR PRIMERA FASE"){
                          if(!is.null(lista8vos()$data_resumenEquipos)){
                            paste0(e54()[1])}
                        }else{
                          tags$span(style="color:red",
                                    alarma4s##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
``` 

### [W60]

```{r}
partido1<-55
partido2<-56

fluidRow(
  
  column(4,
         h2(paste0("W",partido1))
  ),
  
  column(4,
         numericInput(paste0("W",partido1),
                      renderUI(
                        if(lista8vos()!="MENSAJE SIN CONCLUIR PRIMERA FASE"){
                          if(!is.null(lista8vos()$data_resumenEquipos)){
                            paste0(e55()[1])}
                        }else{
                          tags$span(style="color:red",
                                    alarma4s##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
fluidRow(
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
         )),
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
         ))
  
)

fluidRow(
  column(4,
         h2(paste0("W",partido2))
  ),
  
  column(4,
         numericInput(paste0("W",partido2),
                      renderUI(
                        if(lista8vos()!="MENSAJE SIN CONCLUIR PRIMERA FASE"){
                          if(!is.null(lista8vos()$data_resumenEquipos)){
                            paste0(e56()[1])}
                        }else{
                          tags$span(style="color:red",
                                    alarma4s##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
``` 


Row {data-height=100}
-------------------------------------
  
  
```{r}
library(shinyjs)

dataW4s<-reactive({data.frame("Codigo"=c("W_57_E1","W_57_E2",
                                         "W_58_E1","W_58_E2",
                                         "W_59_E1","W_59_E2",
                                         "W_60_E1","W_60_E2"),
                              "Equipo"=c(paste0(e49()[1]),paste0(e50()[1]),
                                         paste0(e53()[1]),paste0(e54()[1]),
                                         paste0(e51()[1]),paste0(e52()[1]),
                                         paste0(e55()[1]),paste0(e56()[1]))
)
  # eventReactive({ input$buttonA input$buttonB input$buttonC input$buttonD input$buttonE input$buttonF input$buttonG input$buttonH}
})


lista4s<-eventReactive(input$button4s,{
  
  if(v4s$OK[1] & v4s$OK[2]){
    # print("holi")
    calcula_Goles(vectorgoles=c(input[["W49"]],input[["W50"]],#input[[paste0("E1",Grupo1)]],
                                input[["W53"]],input[["W54"]],
                                input[["W51"]],input[["W52"]],
                                input[["W55"]],input[["W56"]]),
                  data=dataW4s()
    )
  }else{
    "MENSAJE SIN CONCLUIR SEGUNDA FASE"
  }
})
fluidRow(
  
  column(7,
         actionButton("button4s","  NO TE VAYAS SIN ACTUALIZARME    :P")
  ),
  
  column(7,
         renderTable({
           if(lista4s()=="MENSAJE SIN CONCLUIR SEGUNDA FASE"){
             m<-matrix("SEGUNDA FASE SIN CONCLUIR CORRECTAMENTE")
             colnames(m)<-"¡¡¡O.O!!!!"
             m
           }else if(!is.null(lista4s()$data_EquipoPartido)){
             if(lista2A()$marcaBoton & lista2B()$marcaBoton){
               if(lista4s()$marcaBoton){
                 if(sum(lista4s()$data_EquipoPartido$Empate)==0){
                   as.matrix(lista4s()$data_EquipoPartido[1:4,c("Grupo","Partido","Equipo")])
                 }else{
                   m<-matrix("</3 Cámbialo porfiiiiis")
                   colnames(m)<-"¡¡¡NO MAMAR QUE PUSISTE EMPATES!!!!"
                   m
                 }
                 
               }else{
                 m<-matrix("Por favor revisa que las cantidades de Segunda Fase sean correctas :O")
                 colnames(m)<-"¡¡¡AGUAS!!!!"
                 m
               }
             }else{
               m<-matrix("Por favor revisa que las cantidades de Primera Fase sean correctas :O")
               colnames(m)<-"¡¡¡AGUAS!!!!"
               m
             }
             
           }else{
             m<-matrix("Por favor revisa que las cantidades ingresadas sean correctas")
             colnames(m)<-"¡¡¡AGUAS!!!!"
             m
           }
           
         })
         
  )
)
```

Semifinales
=======================================================================
  
```{r}
e57<-reactive({#input$buttonA, {
  etopn(lista4s()$data_EquipoPartido[lista4s()$data_EquipoPartido$Partido==57,],n=1)
})
e58<-reactive({#input$buttonA, {
  etopn(lista4s()$data_EquipoPartido[lista4s()$data_EquipoPartido$Partido==58,],n=1)
})
e59<-reactive({#input$buttonA, {
  etopn(lista4s()$data_EquipoPartido[lista4s()$data_EquipoPartido$Partido==59,],n=1)
})
e60<-reactive({#input$buttonA, {
  etopn(lista4s()$data_EquipoPartido[lista4s()$data_EquipoPartido$Partido==60,],n=1)
})

vSemis <- reactiveValues(OK = c(F,F))

observeEvent(input$button4s, {
  if(lista4s()=="MENSAJE SIN CONCLUIR SEGUNDA FASE"){
    vSemis$OK[1] <- F
    vSemis$OK[2] <- F
  }else{
    vSemis$OK[1] <- lista4s()$marcaBoton
    vSemis$OK[2] <- sum(lista4s()$data_EquipoPartido$Empate)==0
  }
})

alarmaSemis<-paste0("¡¡O.O Chequemos las fases anteriores DX!!")
```

Row
-------------------------------------
  
### [W61]
  
```{r}

partido1<-57
partido2<-58

fluidRow(
  
  column(4,
         h2(paste0("W",partido1))
  ),
  
  column(4,
         numericInput(paste0("W",partido1),
                      renderUI(
                        if(lista4s()!="MENSAJE SIN CONCLUIR SEGUNDA FASE"){
                          if(!is.null(lista4s()$data_resumenEquipos)){
                            paste0(e57()[1])}
                        }else{
                          tags$span(style="color:red",
                                    alarmaSemis##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
fluidRow(
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
         )),
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
         ))
  
)

fluidRow(
  column(4,
         h2(paste0("W",partido2))
  ),
  
  column(4,
         numericInput(paste0("W",partido2),
                      renderUI(
                        if(lista4s()!="MENSAJE SIN CONCLUIR SEGUNDA FASE"){
                          if(!is.null(lista4s()$data_resumenEquipos)){
                            paste0(e58()[1])}
                        }else{
                          tags$span(style="color:red",
                                    alarmaSemis##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
```

Row
-------------------------------------
  
### [W62]
  
```{r}
partido1<-59
partido2<-60

fluidRow(
  
  column(4,
         h2(paste0("W",partido1))
  ),
  
  column(4,
         numericInput(paste0("W",partido1),
                      renderUI(
                        if(lista4s()!="MENSAJE SIN CONCLUIR SEGUNDA FASE"){
                          if(!is.null(lista4s()$data_resumenEquipos)){
                            paste0(e59()[1])}
                        }else{
                          tags$span(style="color:red",
                                    alarmaSemis##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
fluidRow(
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
         )),
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
         ))
  
)

fluidRow(
  column(4,
         h2(paste0("W",partido2))
  ),
  
  column(4,
         numericInput(paste0("W",partido2),
                      renderUI(
                        if(lista4s()!="MENSAJE SIN CONCLUIR SEGUNDA FASE"){
                          if(!is.null(lista4s()$data_resumenEquipos)){
                            paste0(e60()[1])}
                        }else{
                          tags$span(style="color:red",
                                    alarmaSemis##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
```


Row {data-height=100}
-------------------------------------
  
  
```{r}
library(shinyjs)

dataW2s<-reactive({data.frame("Codigo"=c("W_61_E1","W_61_E2",
                                         "W_62_E1","W_62_E2"),
                              "Equipo"=c(paste0(e57()[1]),paste0(e58()[1]),
                                         paste0(e59()[1]),paste0(e60()[1]))
)
  # eventReactive({ input$buttonA input$buttonB input$buttonC input$buttonD input$buttonE input$buttonF input$buttonG input$buttonH}
})


listaSemis<-eventReactive(input$buttonSemis,{
  
  if(vSemis$OK[1] & vSemis$OK[2]){
    # print("holi")
    calcula_Goles(vectorgoles=c(input[["W57"]],input[["W58"]],#input[[paste0("E1",Grupo1)]],
                                input[["W59"]],input[["W60"]]),
                  data=dataW2s()
    )
  }else{
    "MENSAJE SIN CONCLUIR FASE DE CUARTOS"
  }
})
fluidRow(
  
  column(7,
         actionButton("buttonSemis","  NO TE VAYAS SIN ACTUALIZARME    :P")
  ),
  
  column(7,
         renderTable({
           if(listaSemis()=="MENSAJE SIN CONCLUIR FASE DE CUARTOS"){
             m<-matrix("FASE DE CUARTOS SIN CONCLUIR CORRECTAMENTE")
             colnames(m)<-"¡¡¡O.O!!!!"
             m
           }else if(!is.null(listaSemis()$data_EquipoPartido)){
             if(lista2A()$marcaBoton & lista2B()$marcaBoton){
               if(listaSemis()$marcaBoton){
                 if(sum(listaSemis()$data_EquipoPartido$Empate)==0){
                   as.matrix(listaSemis()$data_EquipoPartido[1:4,c("Grupo","Partido","Equipo")])
                 }else{
                   m<-matrix("</3 Cámbialo porfiiiiis")
                   colnames(m)<-"¡¡¡NO MAMAR QUE PUSISTE EMPATES!!!!"
                   m
                 }
                 
               }else{
                 m<-matrix("Por favor revisa que las cantidades de la Fase de Cuartos sean correctas :O")
                 colnames(m)<-"¡¡¡AGUAS!!!!"
                 m
               }
             }else{
               m<-matrix("Por favor revisa que las cantidades de Primera Fase sean correctas :O")
               colnames(m)<-"¡¡¡AGUAS!!!!"
               m
             }
             
           }else{
             m<-matrix("Por favor revisa que las cantidades ingresadas sean correctas")
             colnames(m)<-"¡¡¡AGUAS!!!!"
             m
           }
           
         })
         
  )
)
```

Finales {data-orientation=columns}
=======================================================================
  
  Column
-------------------------------------
  
```{r}
e61<-reactive({#input$buttonA, {
  etopn(listaSemis()$data_EquipoPartido[listaSemis()$data_EquipoPartido$Partido==61,],n=2)
})
e62<-reactive({#input$buttonA, {
  etopn(listaSemis()$data_EquipoPartido[listaSemis()$data_EquipoPartido$Partido==62,],n=2)
})

vFinales <- reactiveValues(OK = c(F,F))

observeEvent(input$buttonSemis, {
  if(listaSemis()=="MENSAJE SIN CONCLUIR FASE DE CUARTOS"){
    vFinales$OK[1] <- F
    vFinales$OK[2] <- F
  }else{
    vFinales$OK[1] <- listaSemis()$marcaBoton
    vFinales$OK[2] <- sum(listaSemis()$data_EquipoPartido$Empate)==0
  }
})

alarmaSemis<-paste0("¡¡O.O Chequemos las fases anteriores DX DX!!")
```

<!-- Row -->
  <!-- ------------------------------------- -->
  
### FINAL
  
```{r}

partido1<-61
partido2<-62

fluidRow(
  
  column(4,
         h2(paste0("W",partido1))
  ),
  
  column(4,
         numericInput(paste0("W",partido1,"E1"),
                      renderUI(
                        if(listaSemis()!="MENSAJE SIN CONCLUIR FASE DE CUARTOS"){
                          if(!is.null(listaSemis()$data_resumenEquipos)){
                            paste0(e61()[1])}
                        }else{
                          tags$span(style="color:red",
                                    alarmaSemis##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
fluidRow(
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
         )),
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
         ))
  
)

fluidRow(
  column(4,
         h2(paste0("W",partido2))
  ),
  
  column(4,
         numericInput(paste0("W",partido2,"E1"),
                      renderUI(
                        if(listaSemis()!="MENSAJE SIN CONCLUIR FASE DE CUARTOS"){
                          if(!is.null(listaSemis()$data_resumenEquipos)){
                            paste0(e62()[1])}
                        }else{
                          tags$span(style="color:red",
                                    alarmaSemis##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
```

<!-- Row -->
  <!-- ------------------------------------- -->
  
### TERCER LUGAR
  
```{r}
partido1<-61
partido2<-62

fluidRow(
  
  column(4,
         h2(paste0("W",partido1))
  ),
  
  column(4,
         numericInput(paste0("W",partido1,"E2"),
                      renderUI(
                        if(listaSemis()!="MENSAJE SIN CONCLUIR FASE DE CUARTOS"){
                          if(!is.null(listaSemis()$data_resumenEquipos)){
                            paste0(e61()[2])}
                        }else{
                          tags$span(style="color:red",
                                    alarmaSemis##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
fluidRow(
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----   "), sep = ""))
         )),
  
  column(4,
         tags$div(
           HTML(paste(tags$span(style="color:white", "----"),tags$h3(style="color:red", "vs"), sep = ""))
         ))
  
)

fluidRow(
  column(4,
         h2(paste0("W",partido2))
  ),
  
  column(4,
         numericInput(paste0("W",partido2,"E2"),
                      renderUI(
                        if(listaSemis()!="MENSAJE SIN CONCLUIR FASE DE CUARTOS"){
                          if(!is.null(listaSemis()$data_resumenEquipos)){
                            paste0(e62()[2])}
                        }else{
                          tags$span(style="color:red",
                                    alarmaSemis##,unique(lista2A()$data_EquipoPartido$Grupo),"!")
                          )
                        }
                      ),
                      min=0, max=100, value=0,step=1,
                      width = '100px')
  )
)
```


Column {data-width=180}
-------------------------------------
  
### G A N A D O R {data-height=1200}

```{r}
library(shinyjs)

dataW1s<-reactive({data.frame("Codigo"=c("W_64_E1","W_64_E2",
                                         "W_63_E1","W_63_E2"),
                              "Equipo"=c(paste0(e61()[1]),paste0(e62()[1]),
                                         paste0(e61()[2]),paste0(e62()[2]))
)
  # eventReactive({ input$buttonA input$buttonB input$buttonC input$buttonD input$buttonE input$buttonF input$buttonG input$buttonH}
})


listaFinales<-eventReactive(input$buttonFinales,{
  
  if(vFinales$OK[1] & vFinales$OK[2]){
    # print("holi")
    calcula_Goles(vectorgoles=c(input[["W61E1"]],input[["W62E1"]],#input[[paste0("E1",Grupo1)]],
                                input[["W61E2"]],input[["W62E2"]]),
                  data=dataW1s()
    )
  }else{
    "MENSAJE SIN CONCLUIR FASE DE SEMIS"
  }
})
fluidRow(
  
  column(7,
         actionButton("buttonFinales"," ¡TU GANADOR! ")
  ),
  
  column(7,
         renderTable({
           if(listaFinales()=="MENSAJE SIN CONCLUIR FASE DE SEMIS"){
             m<-matrix("FASE DE SEMIFINALES SIN CONCLUIR CORRECTAMENTE")
             colnames(m)<-"¡¡¡O.O!!!!"
             m
           }else if(!is.null(listaFinales()$data_EquipoPartido)){
             if(lista2A()$marcaBoton & lista2B()$marcaBoton){
               if(listaFinales()$marcaBoton){
                 if(sum(listaFinales()$data_EquipoPartido$Empate)==0){
                   pais<-listaFinales()$data_EquipoPartido[1:2,c("Grupo","Partido","Equipo")]
                   m<-as.matrix(pais$Equipo[pais$Partido==64])
                   colnames(m)<-"¡¡¡TU CAMPEÓN!!!!"
                   m
                   #[,listaFinales()$data_EquipoPartido$Partido==64])
                 }else{
                   m<-matrix("</3 Cámbialo porfiiiiis")
                   colnames(m)<-"¡¡¡NO MAMAR QUE PUSISTE EMPATES!!!!"
                   m
                 }
                 
               }else{
                 m<-matrix("Por favor revisa que las cantidades de sean correctas :O")
                 colnames(m)<-"¡¡¡AGUAS!!!!"
                 m
               }
             }else{
               m<-matrix("Por favor revisa que las cantidades de Primera Fase sean correctas :O")
               colnames(m)<-"¡¡¡AGUAS!!!!"
               m
             }
             
           }else{
             m<-matrix("Por favor revisa que las cantidades ingresadas sean correctas")
             colnames(m)<-"¡¡¡AGUAS!!!!"
             m
           }
           
         })
         
  )
)

fluidRow(
  
  column(7,
         renderTable({
           if(listaFinales()=="MENSAJE SIN CONCLUIR FASE DE SEMIS"){

           }else if(!is.null(listaFinales()$data_EquipoPartido)){
             if(lista2A()$marcaBoton & lista2B()$marcaBoton){
               if(listaFinales()$marcaBoton){
                 if(sum(listaFinales()$data_EquipoPartido$Empate)==0){
                   pais<-listaFinales()$data_EquipoPartido[3:4,c("Grupo","Partido","Equipo")]
                   m<-as.matrix(pais$Equipo[pais$Partido==64])
                   colnames(m)<-"¡¡¡TU SEGUNDO LUGAR!!!!"
                   m
                   #[,listaFinales()$data_EquipoPartido$Partido==64])
                  }}}}
         })
  )
)

fluidRow(
  
  column(7,
         renderTable({
           if(listaFinales()=="MENSAJE SIN CONCLUIR FASE DE SEMIS"){

           }else if(!is.null(listaFinales()$data_EquipoPartido)){
             if(lista2A()$marcaBoton & lista2B()$marcaBoton){
               if(listaFinales()$marcaBoton){
                 if(sum(listaFinales()$data_EquipoPartido$Empate)==0){
                   pais<-listaFinales()$data_EquipoPartido[1:2,c("Grupo","Partido","Equipo")]
                   m<-as.matrix(pais$Equipo[pais$Partido==63])
                   colnames(m)<-"¡¡¡TU TERCER LUGAR!!!!"
                   m
                   #[,listaFinales()$data_EquipoPartido$Partido==64])
                  }}}}
         })
  )
)
```

### Paso Final

```{r}

fluidRow(
  # column(5,
                renderUI({
                    downloadButton("downloadData1", "Descarga tu quiniela")
                })
  # )
)

pegar1Fase<-function(g1,g2,g3,g4,g5,g6,g7,g8,
                     w1,w2,w3,w4,
                     nomequipo,
                     nomconcursante,
                     correo){
  data<-rbind(g1,g2,g3,g4,g5,g6,g7,g8,w1,w2,w3,w4)
  data$nomequipo<-nomequipo
  data$nomconcursante<-nomconcursante
  data$correo<-correo
  return(data)
}
data1F<-reactive({
  pegar1Fase<-pegar1Fase(lista2A()$data_EquipoPartido,
                         lista2B()$data_EquipoPartido,
                         lista2C()$data_EquipoPartido,
                         lista2D()$data_EquipoPartido,
                         lista2E()$data_EquipoPartido,
                        lista2F()$data_EquipoPartido, 
                        lista2G()$data_EquipoPartido,
                        lista2H()$data_EquipoPartido,
                        lista8vos()$data_EquipoPartido,
                        lista4s()$data_EquipoPartido,
                        listaSemis()$data_EquipoPartido,
                        listaFinales()$data_EquipoPartido,
                        input$nombre_part,
                        input$nombre_equipo,
                        input$correo)
})
output$downloadData1 <- downloadHandler(
    filename = function() { 
      paste(Sys.time(),input$correo,'.csv', sep='') 
    },
    content = function(file) {
      write.csv(data1F(), file, sep = ".csv",
        row.names = FALSE)
    }
  )

# renderTable(lista2A()$data_EquipoPartido)


```